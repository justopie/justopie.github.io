<div class="highlight"><pre>
<span class="brkt">(</span><span class="func">defun</span> <span class="func">C:AddToPG</span> <span class="brkt">(</span> <span class="func">/</span> <span class="func">_doc</span> dcl_id data value group <span class="func">lstNumbers</span> strMsg objPG <span class="func">ss</span> blnClick<span class="brkt">)</span>
  <span class="brkt">(</span><span class="func">setq</span> <span class="func">ss</span> <span class="brkt">(</span><span class="func">ssget</span> <span class="quot">'</span><span class="brkt">((</span><span class="int">0</span> <span class="quot">.</span> <span class="str">"AECC_COGO_POINT"</span><span class="brkt">))))</span>
  <span class="brkt">(</span><span class="func">vlax-map-collection</span>
    <span class="brkt">(</span><span class="func">vla-get-activeselectionset</span>
      <span class="brkt">(</span><span class="func">setq</span> <span class="func">_doc</span> <span class="brkt">(</span><span class="func">vla-get-activedocument</span> <span class="brkt">(</span><span class="func">vlax-get-acad-object</span><span class="brkt">)))</span>
    <span class="brkt">)</span>
    <span class="quot">'</span><span class="brkt">(</span><span class="func">lambda</span> <span class="brkt">(</span>x<span class="brkt">)</span>
       <span class="brkt">(</span><span class="func">setq</span> <span class="func">lstNumbers</span>
	      <span class="brkt">(</span><span class="func">append</span> <span class="func">lstNumbers</span>
		      <span class="brkt">(</span><span class="func">list</span> <span class="brkt">(</span><span class="func">vlax-get-property</span> x <span class="quot">'</span>Number<span class="brkt">))</span>
	      <span class="brkt">)</span>
       <span class="brkt">)</span>
     <span class="brkt">)</span>
  <span class="brkt">)</span>
  <span class="brkt">(</span><span class="func">setq</span> dcl_id <span class="brkt">(</span><span class="func">load_dialog</span> <span class="str">"C:\\Projects\\git\\justopie\\_codesamples\\pg.DCL"</span><span class="brkt">))</span>
  <span class="brkt">(</span><span class="func">if</span> <span class="brkt">(</span><span class="func">not</span> <span class="brkt">(</span><span class="func">new_dialog</span> <span class="str">"AddToPointGroup"</span> dcl_id<span class="brkt">))</span>
    <span class="brkt">(</span><span class="func">exit</span><span class="brkt">)</span>
  <span class="brkt">)</span><span class="cmt">;if</span>
  <span class="brkt">(</span><span class="func">setq</span> Data <span class="brkt">(</span><span class="func">CollectionNames-&gt;List</span> <span class="brkt">(</span><span class="func">vlax-get-property</span> <span class="brkt">(</span><span class="func">m:c3ddoc</span><span class="brkt">)</span> <span class="quot">'</span>PointGroups<span class="brkt">))</span>
	<span class="func">e</span> <span class="str">""</span>
	<span class="func">n</span> <span class="str">""</span>
	group <span class="func">nil</span><span class="brkt">)</span>
  <span class="brkt">(</span><span class="func">UpdateList</span> <span class="str">"ePG"</span> Data<span class="brkt">)</span>
  <span class="brkt">(</span><span class="func">action_tile</span>
    <span class="str">"cancel"</span>
    <span class="str">"(done_dialog) (setq userclick nil)"</span>
  <span class="brkt">)</span>
  <span class="brkt">(</span><span class="func">action_tile</span>
    <span class="str">"accept"</span>
    <span class="brkt">(</span><span class="func">strcat</span>
      <span class="str">"(progn (setq e (get_tile \"ePG\"))"</span>
      <span class="str">"(setq n (get_tile \"nPG\"))"</span>
      <span class="str">" (done_dialog)(setq blnClick T))"</span>
    <span class="brkt">)</span>
  <span class="brkt">)</span>
  <span class="brkt">(</span><span class="func">start_dialog</span><span class="brkt">)</span>
  <span class="brkt">(</span><span class="func">unload_dialog</span> dcl_id<span class="brkt">)</span>
  <span class="brkt">(</span><span class="func">if</span> blnClick
    <span class="brkt">(</span><span class="func">progn</span>
      <span class="brkt">(</span><span class="func">cond</span> <span class="brkt">((</span><span class="func">&gt;</span> <span class="brkt">(</span><span class="func">strlen</span> <span class="func">e</span><span class="brkt">)</span> <span class="int">0</span><span class="brkt">)</span>
	     <span class="brkt">(</span><span class="func">setq</span> value <span class="brkt">(</span><span class="func">nth</span> <span class="brkt">(</span><span class="func">atoi</span> <span class="func">e</span><span class="brkt">)</span> Data<span class="brkt">)</span>
		   strMsg	 <span class="brkt">(</span><span class="func">strcat</span> <span class="str">"Existing Point Group: "</span> value<span class="brkt">)</span>
		   objPG <span class="brkt">(</span><span class="func">GetPointGroup</span> value<span class="brkt">)</span>
	     <span class="brkt">)</span>
	    <span class="brkt">)</span>
	    <span class="brkt">((</span><span class="func">&gt;</span> <span class="brkt">(</span><span class="func">strlen</span> <span class="func">n</span><span class="brkt">)</span> <span class="int">0</span><span class="brkt">)</span>
	     <span class="brkt">(</span><span class="func">setq</span> value <span class="func">n</span>
		   strMsg	 <span class="brkt">(</span><span class="func">strcat</span> <span class="str">"New Point Group: "</span> value<span class="brkt">)</span>
		   objPG <span class="brkt">(</span><span class="func">AddPointGroup</span> value<span class="brkt">)</span>
	     <span class="brkt">)</span>
	    <span class="brkt">)</span>
      <span class="brkt">)</span>
      <span class="brkt">(</span><span class="func">foreach</span> <span class="func">n</span> <span class="func">lstNumbers</span> <span class="brkt">(</span><span class="func">AddPointToGroup</span> <span class="func">n</span> objPG<span class="brkt">))</span>

      <span class="brkt">(</span><span class="func">princ</span> strMsg<span class="brkt">)</span>
    <span class="brkt">)</span> 
  <span class="brkt">)</span>
  <span class="brkt">(</span><span class="func">if</span> group
    group
    <span class="brkt">(</span><span class="func">princ</span><span class="brkt">)</span>
  <span class="brkt">)</span>
<span class="brkt">)</span><span class="cmt">;defun</span>
</pre></div>
